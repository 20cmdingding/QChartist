<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../../displayToc.js"></script>
<script language="JavaScript" src="../../../tocParas.js"></script>
<script language="JavaScript" src="../../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../../scineplex.css">
<title></title>
<link rel="stylesheet" href="../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#VERSION">VERSION</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a>
    <ul>
      <li><a href="#blib_to_par">blib_to_par</a></li>
      <li><a href="#install_par">install_par</a></li>
      <li><a href="#uninstall_par">uninstall_par</a></li>
      <li><a href="#sign_par">sign_par</a></li>
      <li><a href="#verify_par">verify_par</a></li>
      <li><a href="#merge_par">merge_par</a></li>
      <li><a href="#remove_man">remove_man</a></li>
      <li><a href="#get_meta">get_meta</a></li>
      <li><a href="#parse_dist_name">parse_dist_name</a></li>
      <li><a href="#generate_blib_stub">generate_blib_stub</a></li>
      <li><a href="#contains_binaries">contains_binaries</a></li>
    </ul>
  </li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#AUTHORS">AUTHORS</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>PAR::Dist - Create and manipulate PAR distributions</p>

<h1 id="VERSION">VERSION</h1>

<p>This document describes version 0.47 of PAR::Dist, released November 29, 2009.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p>As a shell command:</p>

<pre><code>    % perl -MPAR::Dist -eblib_to_par</code></pre>

<p>In programs:</p>

<pre><code>    <span class="keyword">use</span> <span class="variable">PAR::Dist</span><span class="operator">;</span>
    
    <span class="keyword">my</span> <span class="variable">$dist</span> <span class="operator">=</span> <span class="variable">blib_to_par</span><span class="operator">();</span> <span class="comment"># make a PAR file using ./blib/</span>
    <span class="variable">install_par</span><span class="operator">(</span><span class="variable">$dist</span><span class="operator">);</span>       <span class="comment"># install it into the system</span>
    <span class="variable">uninstall_par</span><span class="operator">(</span><span class="variable">$dist</span><span class="operator">);</span>     <span class="comment"># uninstall it from the system</span>
    <span class="variable">sign_par</span><span class="operator">(</span><span class="variable">$dist</span><span class="operator">);</span>          <span class="comment"># sign it using Module::Signature</span>
    <span class="variable">verify_par</span><span class="operator">(</span><span class="variable">$dist</span><span class="operator">);</span>        <span class="comment"># verify it using Module::Signature</span>
    
    <span class="variable">install_par</span><span class="operator">(</span><span class="string">"http://foo.com/DBI-1.37-MSWin32-5.8.0.par"</span><span class="operator">);</span> <span class="comment"># works too</span>
    <span class="variable">install_par</span><span class="operator">(</span><span class="string">"http://foo.com/DBI-1.37"</span><span class="operator">);</span> <span class="comment"># auto-appends archname + perlver</span>
    <span class="variable">install_par</span><span class="operator">(</span><span class="string">"cpan://SMUELLER/PAR-Packer-0.975"</span><span class="operator">);</span> <span class="comment"># uses CPAN author directory</span>
</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This module creates and manipulates <i>PAR distributions</i>. They are architecture-specific <b>PAR</b> files, containing everything under <i>blib/</i> of CPAN distributions after their <code>make</code> or <code>Build</code> stage, a <i>META.yml</i> describing metadata of the original CPAN distribution, and a <i>MANIFEST</i> detailing all files within it. Digitally signed PAR distributions will also contain a <i>SIGNATURE</i> file.</p>

<p>The naming convention for such distributions is:</p>

<pre><code>    $NAME-$VERSION-$ARCH-$PERL_VERSION.par</code></pre>

<p>For example, <code>PAR-Dist-0.01-i386-freebsd-5.8.0.par</code> corresponds to the 0.01 release of <code>PAR-Dist</code> on CPAN, built for perl 5.8.0 running on <code>i386-freebsd</code>.</p>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<p>Several functions are exported by default. Unless otherwise noted, they can take either a hash of named arguments, a single argument (taken as <code>$path</code> by <code>blib_to_par</code> and <code>$dist</code> by other functions), or no arguments (in which case the first PAR file in the current directory is used).</p>

<p>Therefore, under a directory containing only a single <i>test.par</i>, all invocations below are equivalent:</p>

<pre><code>    <span class="operator">% </span><span class="variable">perl</span> <span class="operator">-</span><span class="variable">MPAR::Dist</span> <span class="keyword">-e</span><span class="string">"install_par( dist =&gt; 'test.par' )"</span>
    <span class="operator">% </span><span class="variable">perl</span> <span class="operator">-</span><span class="variable">MPAR::Dist</span> <span class="keyword">-e</span><span class="string">"install_par( 'test.par' )"</span>
    <span class="operator">% </span><span class="variable">perl</span> <span class="operator">-</span><span class="variable">MPAR::Dist</span> <span class="operator">-</span><span class="variable">einstall_par</span><span class="operator">;</span>
</code></pre>

<p>If <code>$dist</code> resembles a URL, <code>LWP::Simple::mirror</code> is called to mirror it locally under <code><span class="variable">$ENV</span><span class="operator">{</span><span class="string">PAR_TEMP</span><span class="operator">}</span>
</code> (or <code>$TEMP/par/</code> if unspecified), and the function will act on the fetched local file instead. If the URL begins with <code>cpan://AUTHOR/</code>, it will be expanded automatically to the author&#39;s CPAN directory (e.g. <code>http://www.cpan.org/modules/by-authors/id/A/AU/AUTHOR/</code>).</p>

<p>If <code>$dist</code> does not have a file extension beginning with a letter or underscore, a dash and <code>$suffix</code> ($ARCH-$PERL_VERSION.par by default) will be appended to it.</p>

<h2 id="blib_to_par">blib_to_par</h2>

<p>Takes key/value pairs as parameters or a single parameter indicating the path that contains the <i>blib/</i> subdirectory.</p>

<p>Builds a PAR distribution from the <i>blib/</i> subdirectory under <code>path</code>, or under the current directory if unspecified. If <i>blib/</i> does not exist, it automatically runs <i>Build</i>, <i>make</i>, <i>Build.PL</i> or <i>Makefile.PL</i> to create it.</p>

<p>Returns the filename of the generated PAR distribution.</p>

<p>Valid parameters are:</p>

<dl>

<dt id="path">path</dt>
<dd>

<p>Sets the path which contains the <i>blib/</i> subdirectory from which the PAR distribution will be generated.</p>

</dd>
<dt id="name-version-suffix">name, version, suffix</dt>
<dd>

<p>These attributes set the name, version and platform specific suffix of the distribution. Name and version can be automatically determined from the distributions <i>META.yml</i> or <i>Makefile.PL</i> files.</p>

<p>The suffix is generated from your architecture name and your version of perl by default.</p>

</dd>
<dt id="dist">dist</dt>
<dd>

<p>The output filename for the PAR distribution.</p>

</dd>
<dt id="quiet">quiet</dt>
<dd>

<p>Set to true to suppress as much output as possible.</p>

</dd>
</dl>

<h2 id="install_par">install_par</h2>

<p>Installs a PAR distribution into the system, using <code>ExtUtils::Install::install_default</code>.</p>

<p>If only a single parameter is given, it is treated as the value for the <code>dist</code> parameter.</p>

<p>Valid named parameters are:</p>

<dl>

<dt id="dist1">dist</dt>
<dd>

<p>The .par file to install. The heuristics outlined in the <b>FUNCTIONS</b> section above apply.</p>

</dd>
<dt id="prefix">prefix</dt>
<dd>

<p>This string will be prepended to all installation paths. If it isn&#39;t specified, the environment variable <code>PERL_INSTALL_ROOT</code> is used as a prefix.</p>

</dd>
<dt id="uninstall_shadows">uninstall_shadows</dt>
<dd>

<p>This corresponds to the <code>uninstall_shadows</code> option of <a href="../../../lib/ExtUtils/Install.html">ExtUtils::Install</a>. Quoting its manual: If <code>uninstall_shadows</code> is set to true, any differing versions throughout <code>@INC</code> will be uninstalled. This is <code>make install UNINST=1</code>.</p>

</dd>
<dt id="verbose">verbose</dt>
<dd>

<p>This corresponds to the <code>verbose</code> option of <a href="../../../lib/ExtUtils/Install.html">ExtUtils::Install</a>. According to its manual: If <code>verbose</code> is true, will print out each file removed. This is <code>make install VERBINST=1</code>. <code>verbose</code> values going up to 5 show increasingly more diagnostics output.</p>

<p>Default verbosity for PAR::Dist is 1.</p>

</dd>
</dl>

<p>If you&#39;re just going to install into the running perl like everything else, you can stop reading the rest of this section now.</p>

<p>Additionally, you can use several parameters to change the default installation destinations. You don&#39;t usually have to worry about this unless you are installing into a user-local directory. The following section outlines the parameter names and default settings:</p>

<pre><code>  <span class="variable">Parameter</span>         <span class="variable">From</span>          <span class="variable">To</span>
  <span class="variable">inst_lib</span>          <span class="variable">blib</span><span class="operator">/</span><span class="variable">lib</span>      <span class="variable">$Config</span><span class="operator">{</span><span class="string">installsitelib</span><span class="operator">}</span> <span class="operator">(*)</span>
  <span class="variable">inst_archlib</span>      <span class="variable">blib</span><span class="operator">/</span><span class="variable">arch</span>     <span class="variable">$Config</span><span class="operator">{</span><span class="string">installsitearch</span><span class="operator">}</span>
  <span class="variable">inst_script</span>       <span class="variable">blib</span><span class="operator">/</span><span class="variable">script</span>   <span class="variable">$Config</span><span class="operator">{</span><span class="string">installscript</span><span class="operator">}</span>
  <span class="variable">inst_bin</span>          <span class="variable">blib</span><span class="operator">/</span><span class="variable">bin</span>      <span class="variable">$Config</span><span class="operator">{</span><span class="string">installbin</span><span class="operator">}</span>
  <span class="variable">inst_man1dir</span>      <span class="variable">blib</span><span class="operator">/</span><span class="variable">man1</span>     <span class="variable">$Config</span><span class="operator">{</span><span class="string">installman1dir</span><span class="operator">}</span>
  <span class="variable">inst_man3dir</span>      <span class="variable">blib</span><span class="operator">/</span><span class="variable">man3</span>     <span class="variable">$Config</span><span class="operator">{</span><span class="string">installman3dir</span><span class="operator">}</span>
  <span class="variable">packlist_read</span>                   <span class="variable">$Config</span><span class="operator">{</span><span class="string">sitearchexp</span><span class="operator">}</span><span class="operator">/</span><span class="variable">auto</span><span class="operator">/</span><span class="variable">$name</span><span class="operator">/.</span><span class="variable">packlist</span>
  <span class="variable">packlist_write</span>                  <span class="variable">$Config</span><span class="operator">{</span><span class="string">installsitearch</span><span class="operator">}</span><span class="operator">/</span><span class="variable">auto</span><span class="operator">/</span><span class="variable">$name</span><span class="operator">/.</span><span class="variable">packlist</span>
</code></pre>

<p>The <code>packlist_write</code> parameter is used to control where the <i>.packlist</i> file is written to. (Necessary for uninstallation.) The <code>packlist_read</code> parameter specifies a .packlist file to merge in if it exists. By setting any of the above installation targets to <code>undef</code>, you can remove that target altogether. For example, passing <code>inst_man1dir =&gt; undef, inst_man3dir =&gt; undef</code> means that the contained manual pages won&#39;t be installed. This is not available for the packlists.</p>

<p>Again, the defaults will be the normal <i>site</i> paths from <code>%Config</code>.</p>

<p>(*) If the <code>.par</code>&#39;s <i>inst_archlib</i> section (normally <code>blib/arch</code>) isn&#39;t empty, the code in <i>inst_lib</i> (normally <code>blib/lib</code>) is also installed into the <i>inst_archlib</i> path. This makes sense for XS modules. If, however, you override <code>inst_lib</code>, this automatic conversion is also overridden! You can use the named parameter <code>auto_inst_lib_conversion =&gt; 1</code> to re-enable the conversion for custom <i>inst_lib</i>&#39;s.</p>

<p>Finally, you may specify a <code>custom_targets</code> parameter. Its value should be a reference to a hash of custom installation targets such as</p>

<pre><code>  <span class="string">custom_targets</span> <span class="operator">=&gt;</span> <span class="operator">{</span> <span class="string">'blib/my_data'</span> <span class="operator">=&gt;</span> <span class="string">'/some/path/my_data'</span> <span class="operator">}</span>
</code></pre>

<p>You can use this to install the <i>.par</i> archives contents to arbitrary locations.</p>

<h2 id="uninstall_par">uninstall_par</h2>

<p>Uninstalls all previously installed contents of a PAR distribution, using <code>ExtUtils::Install::uninstall</code>.</p>

<p>Takes almost the same parameters as <code>install_par</code>, but naturally, the installation target parameters do not apply. The only exception to this is the <code>packlist_read</code> parameter which specifies the <i>.packlist</i> file to read the list of installed files from. It defaults to <code><span class="variable">$Config::Config</span><span class="operator">{</span><span class="string">installsitearch</span><span class="operator">}</span><span class="operator">/</span><span class="variable">auto</span><span class="operator">/</span><span class="variable">$name</span><span class="operator">/.</span><span class="variable">packlist</span>
</code>.</p>

<p>Additionally, the <code>uninstall_shadows</code> parameter of <code>install_par</code> isn&#39;t available.</p>

<h2 id="sign_par">sign_par</h2>

<p>Digitally sign a PAR distribution using <code>gpg</code> or <b>Crypt::OpenPGP</b>, via <b>Module::Signature</b>.</p>

<h2 id="verify_par">verify_par</h2>

<p>Verify the digital signature of a PAR distribution using <code>gpg</code> or <b>Crypt::OpenPGP</b>, via <b>Module::Signature</b>.</p>

<p>Returns a boolean value indicating whether verification passed; <code>$!</code> is set to the return code of <code>Module::Signature::verify</code>.</p>

<h2 id="merge_par">merge_par</h2>

<p><i>Note:</i> Since version 0.32 of PAR::Dist, this function requires a YAML reader. The order of precedence is:</p>

<pre><code>  YAML:XS YAML YAML::Syck YAML::Tiny</code></pre>

<p>Merges two or more PAR distributions into one. First argument must be the name of the distribution you want to merge all others into. Any following arguments will be interpreted as the file names of further PAR distributions to merge into the first one.</p>

<pre><code>  merge_par(&#39;foo.par&#39;, &#39;bar.par&#39;, &#39;baz.par&#39;)</code></pre>

<p>This will merge the distributions <code>foo.par</code>, <code>bar.par</code> and <code>baz.par</code> into the distribution <code>foo.par</code>. <code>foo.par</code> will be overwritten!</p>

<p>The original META.yml of <code>foo.par</code> is retained, but augmented with any <code>provides</code>, <code>requires</code>, <code>recommends</code>, <code>build_requires</code>, and <code>configure_requires</code> sections from the other <code>.par</code> files.</p>

<h2 id="remove_man">remove_man</h2>

<p>Remove the man pages from a PAR distribution. Takes one named parameter: <i>dist</i> which should be the name (and path) of the PAR distribution file. The calling conventions outlined in the <code>FUNCTIONS</code> section above apply.</p>

<p>The PAR archive will be extracted, stripped of all <code>man\d?</code> and <code>html</code> subdirectories and then repackaged into the original file.</p>

<h2 id="get_meta">get_meta</h2>

<p>Opens a PAR archive and extracts the contained META.yml file. Returns the META.yml file as a string.</p>

<p>Takes one named parameter: <i>dist</i>. If only one parameter is passed, it is treated as the <i>dist</i> parameter. (Have a look at the description in the <code>FUNCTIONS</code> section above.)</p>

<p>Returns undef if no PAR archive or no META.yml within the archive were found.</p>

<h2 id="parse_dist_name">parse_dist_name</h2>

<p>First argument must be a distribution file name. The file name is parsed into <i>distribution name</i>, <i>distribution version</i>, <i>architecture name</i>, and <i>perl version</i>.</p>

<p>Returns the results as a list in the above order. If any or all of the above cannot be determined, returns undef instead of the undetermined elements.</p>

<p>Supported formats are:</p>

<p>Math-Symbolic-0.502-x86_64-linux-gnu-thread-multi-5.8.7</p>

<p>Math-Symbolic-0.502</p>

<p>The &quot;.tar.gz&quot; or &quot;.par&quot; extensions as well as any preceding paths are stripped before parsing. Starting with <code>PAR::Dist</code> 0.22, versions containing a preceding <code>v</code> are parsed correctly.</p>

<p>This function is not exported by default.</p>

<h2 id="generate_blib_stub">generate_blib_stub</h2>

<p>Creates a <i>blib/lib</i> subdirectory in the current directory and prepares a <i>META.yml</i> with meta information for a new PAR distribution. First argument should be the name of the PAR distribution in a format understood by <code>parse_dist_name()</code>. Alternatively, named arguments resembling those of <code>blib_to_par</code> are accepted.</p>

<p>After running <code>generate_blib_stub</code> and injecting files into the <i>blib</i> directory, you can create a PAR distribution using <code>blib_to_par</code>. This function is useful for creating custom PAR distributions from scratch. (I.e. not from an unpacked CPAN distribution) Example:</p>

<pre><code>  <span class="keyword">use</span> <span class="variable">PAR::Dist</span><span class="operator">;</span>
  <span class="keyword">use</span> <span class="variable">File::Copy</span> <span class="string">'copy'</span><span class="operator">;</span>
  
  <span class="variable">generate_blib_stub</span><span class="operator">(</span>
    <span class="string">name</span> <span class="operator">=&gt;</span> <span class="string">'MyApp'</span><span class="operator">,</span> <span class="string">version</span> <span class="operator">=&gt;</span> <span class="string">'1.00'</span>
  <span class="operator">);</span>
  <span class="variable">copy</span><span class="operator">(</span><span class="string">'MyApp.pm'</span><span class="operator">,</span> <span class="string">'blib/lib/MyApp.pm'</span><span class="operator">);</span>
  <span class="variable">blib_to_par</span><span class="operator">();</span> <span class="comment"># generates the .par file!</span>
</code></pre>

<p><code>generate_blib_stub</code> will not overwrite existing files.</p>

<h2 id="contains_binaries">contains_binaries</h2>

<p>This function is not exported by default.</p>

<p>Opens a PAR archive tries to determine whether that archive contains platform-specific binary code.</p>

<p>Takes one named parameter: <i>dist</i>. If only one parameter is passed, it is treated as the <i>dist</i> parameter. (Have a look at the description in the <code>FUNCTIONS</code> section above.)</p>

<p>Throws a fatal error if the PAR archive could not be found.</p>

<p>Returns one if the PAR was found to contain binary code and zero otherwise.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a>PAR</a>, <a href="../../../lib/ExtUtils/Install.html">ExtUtils::Install</a>, <a>Module::Signature</a>, <a href="../../../lib/LWP/Simple.html">LWP::Simple</a></p>

<h1 id="AUTHORS">AUTHORS</h1>

<p>Audrey Tang &lt;cpan@audreyt.org&gt; 2003-2007</p>

<p>Steffen Mueller &lt;smueller@cpan.org&gt; 2005-2011</p>

<p>PAR has a mailing list, &lt;par@perl.org&gt;, that you can write to; send an empty mail to &lt;par-subscribe@perl.org&gt; to join the list and participate in the discussion.</p>

<p>Please send bug reports to &lt;bug-par@rt.cpan.org&gt;.</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2003-2011 by Audrey Tang &lt;autrijus@autrijus.org&gt;.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>See <a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a></p>


</body>

</html>


